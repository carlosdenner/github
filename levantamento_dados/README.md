# LEVANTAMENTO DE DADOS GITHUB

## Processos para acessar dados do Github utilizando a API de REST do GitHub e base de dados do ghTorrent (BigQuery). Esses dados servir√£o como base para realizar an√°lises de fins acad√™micos.

### Pr√©-requisitos
Antes de come√ßar, voc√™ vai precisar ter instalado em sua m√°quina as seguintes ferramentas: 
[Git](https://git-scm.com), [Python3](https://www.python.org/). 
Al√©m disto √© bom ter um editor para trabalhar com o c√≥digo como [VSCode](https://code.visualstudio.com/)
Tamb√©m √© utilizada a biblioteca [Sweetviz](https://pypi.org/project/sweetviz/).

```bash

# Instala√ß√£o Git
$ sudo apt-get install git

# Instala√ß√£o Python3 
$ sudo apt-get install python3

# Instala√ß√£o do Pip
$ sudo apt install python3-pip

# Instala√ß√£o da biblioteca Sweetviz
$ pip install sweetviz

# Clone este reposit√≥rio
$ git clone <https://github.com/carlosdenner/github.git>

# Acesse a pasta levantamento_dados
$ cd levantamento_dados

```

### M√≥dulos

#### M√≥dulos para acessar reposit√≥rios do Github:

- **consulta_repositorios.py**: recebe como entrada as palavras-chave que deseja pesquisa e seus respectivos valores. Exemplo: Deseja pesquisa reposit√≥rios com o t√≥pico open-data, ent√£o deve ser informado palavra-chave = topic e valor palavra-chave = open-data. Sua sa√≠da √© um arquivo JSON com o seguinte formato: palavras-chave:valor palavra-chave-timestamp.json (topic:open-data-2021-06-12 21:21:29.719105.json).
- **consulta_repositorios_todos.py**: vers√£o mais robusta do consulta_repositorios.py. O script busca mais de 1000 reposit√≥rios utilizando a ordena√ß√£o do n√∫mero de estrelas de cada reposit√≥rio. Recomendado utilizar para pesquisas maiores, como exemplo: pesquisar os reposit√≥rios da linguagem Python - language:python.
- **consulta_topicos_de_repositorio.py**: recebe como entrada o arquivo.json com os reposit√≥rios que deseja pesquisar os t√≥picos. Primeiro ele pesquisa na base de dados de reposit√≥rios com as seguintes chaves e na seguinte ordem: a) url -> b) name e data de cria√ß√£o -> c) data de cria√ß√£o. Para os casos n√£o encontrados na base de dados s√£o feitas requisi√ß√µes na API do GITHUB. Essas requisi√ß√µes podem ter problema de erro 403, por isso, s√£o acionadas no √∫ltimo caso, o mais recomendado √© alimentar a base de dados com os dados desejados utilizando os scripts de consulta acioma e o script de atualiza√ß√£o abaixo.
- **atualiza_base.py**: atualiza o arquivo JSON central chamado base_dados_repositorios.json. Recebe como entrada um arquivo contruido no consulta_repositorio.py e verifica reposit√≥rio a reposit√≥rio. Caso o reposit√≥rio exista na base de dados faz atualiza√ß√£o, caso n√£o exista inclui na base de dados.
- **visualiza_dados.py**: recebe como entrada o arquivo central base de dados e faz an√°lises com suas informa√ß√µes. Gera como sa√≠da gr√°ficos em um arquivo html chamado analise_dados.html.

### M√≥dulos para manipular arquivos JSON com informa√ß√µes de estrelas:
Na pasta **estrelas**:

- **identifica_data_criacao_repositorio.py**: recebe como entrada arquivo de reposit√≥rios e arquivo de hist√≥rico de estrelas. Identifica a data de cria√ß√£o do reposit√≥rio e inclui no registro mais antigo do hist√≥rico de estrelas e retorna esse arquivo.
- **gerar_historico_estrelas.py**: recebe como entrada arquivo com o hist√≥rico de estrelas somado por data e tamb√©m com a data de cria√ß√£o do reposit√≥rio. Retorna o arquivo com o hist√≥rico da quantidade de estrelas que o reposit√≥rio possui em cada dia desde sua cria√ß√£o at√© 31/05/2019 (√πltima atualiza√ß√£o da base de dados do BigQuery).
- **gerar_arquivo_dia_estrelas_repo.py**: recebe como entrada arquivo com o hist√≥rico de estrelas original e arquivo com os reposit√≥rios. Retorna as mesmas informa√ß√µes do m√≥dulo acima, por√©m, n√£o possui performace suficiente para processar muitos registros.

### M√≥dulos para manipular arquivos JSON com informa√ß√µes de forks:
Na pasta **forks**:

- **identifica_data_criacao_repositorio.py**: recebe como entrada arquivo de reposit√≥rios e arquivo de hist√≥rico de forks. Identifica a data de cria√ß√£o do reposit√≥rio e inclui no registro mais antigo do hist√≥rico de forks e retorna esse arquivo.
- **gerar_historico_forks.py**: recebe como entrada arquivo com o hist√≥rico de forks somado por data e tamb√©m com a data de cria√ß√£o do reposit√≥rio. Retorna o arquivo com o hist√≥rico da quantidade de forks que o reposit√≥rio possui em cada dia desde sua cria√ß√£o at√© 31/05/2019 (√πltima atualiza√ß√£o da base de dados do BigQuery).

### M√≥dulos para manipular arquivos JSON com informa√ß√µes de contribuidores:
O **contribuidor** √© um usu√°rio que fez um commit no projeto. O data do primeiro commit √© considerada a data de ingresso do contribuidor no projeto.
Na pasta **contribuidores**:

- **identifica_data_criacao_repositorio.py**: recebe como entrada arquivo de reposit√≥rios e arquivo de hist√≥rico de contribuidores. Identifica a data de cria√ß√£o do reposit√≥rio e inclui no registro mais antigo do hist√≥rico de contribuidores e retorna esse arquivo.
- **gerar_historico_contribuidores.py**: recebe como entrada arquivo com o hist√≥rico de contribuidores somado por data e tamb√©m com a data de cria√ß√£o do reposit√≥rio. Retorna o arquivo com o hist√≥rico da quantidade de contribuidores que o reposit√≥rio possui em cada dia desde sua cria√ß√£o at√© 31/05/2019 (√πltima atualiza√ß√£o da base de dados do BigQuery).

### M√≥dulos para manipular arquivos JSON com informa√ß√µes de releases:
Na pasta **releases**:
- **consulta_releases_repositorios.py**: consulta todas as releases dos reposit√≥rios informados no arquivo de entrada. Retorna um arquivo .json com a lista de releases vinculada a cada reposit√≥rio. Caso tenham problema com o token de autentica√ß√£o, basta criar um novo e informar no c√≥digo. Em caso de internet com problema basta alterar o FOR da linha 26 e passar a buscar por quantidade de registros. Exemplo: for x in (range(300,400)): -> busca do registro 300 at√© o 399 do arquivo de entrada. Para juntar os v√°rios arquivos de saida pode ser utilizado o script **junta_arquivos.py**.
Cria√ß√£o de token acesso Github: https://docs.github.com/pt/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token
- **seleciona_releases_entre_datas.py**: recebe o arquivo de sa√≠da do script anterior e seleciona somente as releases que ocorreram entre 01/02/2012 at√© 31/05/2019.
- **gerar_repositorio_data_release.py**: recebe o arquivo de sa√≠da do script anterior e gera arquivo com reposit√≥rio e data da releases.
- **gerar_quantidade_releases_somado_por_dia.py**: recebe o arquivo de sa√≠da do script anterior e soma as releases que ocorreram no mesmo dia. Retorna um arquivo que possui o reposit√≥rio, data e quantidade de releases nessa data para esse reposit√≥rio.
- **gerar_historico_releases.py**: recebe como entrada arquivo com o hist√≥rico de releases somado por data e tamb√©m com a data de cria√ß√£o do reposit√≥rio. Retorna o arquivo com o hist√≥rico da quantidade de releases que o reposit√≥rio possui em cada dia desde sua cria√ß√£o at√© 31/05/2019 (√πltima atualiza√ß√£o da base de dados do BigQuery).
- **identifica_data_criacao_repositorio.py**: recebe como entrada arquivo de reposit√≥rios e arquivo de hist√≥rico de releases. Identifica a data de cria√ß√£o do reposit√≥rio e inclui no registro mais antigo do hist√≥rico de releases e retorna esse arquivo.


### M√≥dulos auxiliares para formata√ß√£o:

- **transformar_created_at_em_data.py**: transformar a data created_at formato timestamp UTC em data formato dd-mm-yyyy.
- **transformar_json_em_csv**: converte um arquivo.json em .csv.

### üõ† Tecnologias

As seguintes ferramentas foram usadas na constru√ß√£o do projeto:

- [Python3](https://www.python.org/)
- [JSON](https://www.json.org/json-en.html)

### Dados

Os dados gerados nesse projeto podem ser acessados pelo link abaixo:
- [Dados](https://drive.google.com/drive/folders/1nwXFGrAOknPYeDqSTQfKhwJRTe4GvilS?usp=sharing)

#### Banco de dados

#### repositorios-com-topicos.csv ou .json
Reposit√≥rios Python ordenados por n√∫mero de estrelas. Selecionado os 1000 primeiros. Nesse arquivo tamb√©m existe uma coluna com a lista de t√≥picos cadastrados no reposit√≥rio.

Fonte: GHTorrent e API REST do GITHUB (para buscar os t√≥picos)

#### CONTRIBUIDORES/quantidade-contribuidores-por-dia.csv ou .json
Hist√≥rico de contribuidores dos 1000 reposit√≥rios. Com esse arquivo √© poss√≠vel saber quantos contribuidores existiam no projeto x na data y.

Fonte: GHTorrent

#### ESTRELAS/quantidade-estrelas-por-dia.csv ou .json
Hist√≥rico de estrelas dos 1000 reposit√≥rios. Com esse arquivo √© poss√≠vel saber quantas estrelas existiam no projeto x na data y.

Fonte: GHTorrent

#### FORKS/quantidade_forks_por_dia.csv ou .json
Hist√≥rico de forks dos 1000 reposit√≥rios. Com esse arquivo √© poss√≠vel saber quantos forks existiam no projeto x na data y.

Fonte: GHTorrent

#### RELEASES/quantidade-releases-por-dia.csv ou .json
Hist√≥rico de releases dos 1000 reposit√≥rios. Com esse arquivo √© poss√≠vel saber quantas releases existiam no projeto x na data y.

Fonte: API REST do Github limitando pelo per√≠odo desde a cria√ß√£o do projeto at√© 31/05/2019 (fim da base GHTorrent)

#### CONTRIBUIDORES/N√çVEL DE EXPERI√äNCIA/historico-contribuidor-data-inicio-github.csv ou .json
Data em que o contribuidor ingressou no Github. Somente os contribuidores dos 1000 reposit√≥rios.

Fonte: GHTorrent

#### CONTRIBUIDORES/N√çVEL DE EXPERI√äNCIA/historico-contribuidor-data-inicio-projeto.csv ou .json
Data em que o contribuidor ingressou no projeto. Somente os contribuidores dos 1000 reposit√≥rios.

Fonte: GHTorrent


#### Cria√ß√£o de banco de dados

##### Hist√≥rico de quantidade de estrelas do reposit√≥rio por dia: 
Arquivo que possui a informa√ß√£o de quantas estrelas o reposit√≥rio X possui na data Y. Informa√ß√µes desde a cria√ß√£o do reposit√≥rio at√© a data de 31/05/2019.

###### Cria√ß√£o
1. Executar no BIGQUERY a QUERY 2 do arquivo consultas_big_query/BIGQUERY-Consultas-GHTorrent. Essa query vai retornar a quantidade de estrelas por dia de cada um dos reposit√≥rios selecionados. Baixe o arquivo JSON do resultado no seu Google Drive.
2. Executar o m√≥dulo **transformar_created_at_em_data.py** (leitura 2) com o arquivo gerado acima. Esse m√≥dulo vai transformar o arquivo em formato JSON lista.
3. Executar o m√≥dulo **identifica_data_criacao_repositorio.py** com o arquivo gerado acima e o arquivo JSON que possui os reposit√≥rios.
4. Executar o m√≥dulo **gerar_historico_estrelas.py** com o arquivo resultado do passo anterior.


##### Hist√≥rico de quantidade de forks do reposit√≥rio por dia: 
Arquivo que possui a informa√ß√£o de quantos forks o reposit√≥rio X possui na data Y. Informa√ß√µes desde a cria√ß√£o do reposit√≥rio at√© a data de 31/05/2019.

###### Cria√ß√£o
1. Executar no BIGQUERY a QUERY 3 do arquivo consultas_big_query/BIGQUERY-Consultas-GHTorrent. Essa query vai retornar a quantidade de forks por dia de cada um dos reposit√≥rios selecionados. Baixe o arquivo JSON do resultado no seu Google Drive.
2. Executar o m√≥dulo **transformar_created_at_em_data.py** (leitura 2) com o arquivo gerado acima. Esse m√≥dulo vai transformar o arquivo em formato JSON lista.
3. Executar o m√≥dulo **identifica_data_criacao_repositorio.py** com o arquivo gerado acima e o arquivo JSON que possui os reposit√≥rios.
4. Executar o m√≥dulo **gerar_historico_forks.py** com o arquivo resultado do passo anterior.

##### Hist√≥rico de quantidade de contribuidores do reposit√≥rio por dia: 
Arquivo que possui a informa√ß√£o de quantos contribuidores o reposit√≥rio X possui na data Y. Informa√ß√µes desde a cria√ß√£o do reposit√≥rio at√© a data de 31/05/2019.

###### Cria√ß√£o
1. Executar no BIGQUERY a QUERY 5 do arquivo consultas_big_query/BIGQUERY-Consultas-GHTorrent. Essa query vai retornar a quantidade de contribuidores por dia de cada um dos reposit√≥rios selecionados. Baixe o arquivo JSON do resultado no seu Google Drive.
2. Executar o m√≥dulo **transformar_created_at_em_data.py** (leitura 2) com o arquivo gerado acima. Esse m√≥dulo vai transformar o arquivo em formato JSON lista.
3. Executar o m√≥dulo **identifica_data_criacao_repositorio.py** com o arquivo gerado acima e o arquivo JSON que possui os reposit√≥rios.
4. Executar o m√≥dulo **gerar_historico_contribuidores.py** com o arquivo resultado do passo anterior.

##### Hist√≥rico de quantidade de releases do reposit√≥rio por dia: 
1. Execute os scripts na seguinte ordem: consulta_releases_repositorios.py -> seleciona_releases_entre_datas.py -> gerar_repositorio_data_release.py -> gerar_quantidade_releases_somado_por_dia.py -> identifica_data_criacao_repositorio.py -> gerar_historico_releases.py